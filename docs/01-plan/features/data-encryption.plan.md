# 종단간 암호화 저장 (data-encryption) Plan Document

> Version: 1.1.0 (v3.1) | Created: 2026-02-18 | Status: In-Progress

## 1. Goal
사용자의 데이터를 브라우저에서 암호화한 후 클라우드(Supabase)에 저장함으로써, 제작자(관리자)를 포함한 그 누구도 사용자의 명시적 허가(암호 키) 없이는 데이터를 열람할 수 없는 **완벽한 프라이버시 보호** 환경을 구축합니다.

## 2. Scope
- **암호화 엔진**: Web Crypto API 또는 `crypto-js`를 이용한 AES-256 알고리즘 적용.
- **키 관리**: 
  - 사용자가 직접 설정하는 '보안 비밀번호(Encryption Key)' 도입.
  - 이 비밀번호는 절대 서버(Supabase)에 저장하지 않으며 로컬에만 안전하게 보관.
- **자동 암/복구**:
  - 클라우드로 업로드 전 자동 암호화.
  - 클라우드에서 다운로드 후 자동 복구.
- **마이그레이션**: 기존의 평문(v3.0) 데이터를 암호화된 데이터(v3.1)로 전환하는 가이드 제공.
- **UI/UX**: 
  - 최초 동기화 시 보안 비밀번호 설정 팝업.
  - 비밀번호 분실 시 데이터 복구 불가에 대한 강력한 안내.

## 3. Tech Stack
- **Library**: `crypto-js` (사용 편의성 및 호환성)
- **Storage**: Supabase (암호화된 문자열 저장)
- **Local Storage**: 암호화 키의 해시값 또는 세션 내 임시 보관.

## 4. Risks & Constraints
- **비밀번호 분실**: 관리자도 복구해 줄 수 없으므로, 분실 시 모든 데이터를 잃게 됨을 사용자에게 명확히 고지해야 함.
- **성능**: 데이터 양이 방대할 경우 암/복호화 과정에서 약간의 지연이 발생할 수 있음 (최적화 필요).

## 5. Timeline (Milestones)
1. **암호화 모듈 개발**: AES-256 기반의 Utility 클래스 작성.
2. **인증 흐름 개선**: 로그인 성공 후 '보안 키' 입력/설정 단계 추가.
3. **동기화 로직 업데이트**: `SupabaseContext` 내의 `upsert` 및 `fetch` 단계에 암/복호화 레이어 삽입.
4. **버전 업데이트 (v3.1)**: 배포 및 사용자 가이드 업데이트.
